{"config":{"lang":["en"],"min_search_length":3,"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"","title":"Home"},{"location":"00_intro/","text":"Introduction \u2693\ufe0e Objectifs \u2693\ufe0e Avec la croissance des produits RFID , il est important de bien comprendre comment la technologie fonctionne et comment l\u2019 utiliser de la mani\u00e8re la plus efficace. Nous allons utiliser une carte Mifare Classic 1K pour exemple. Nous allons ensuite exploiter les failles de s\u00e9curit\u00e9 de cette carte afin de hacker puis cloner la carte en question. RFID ou Radio Frequency IDentification \u2693\ufe0e Tous les jours nous utilisons des produits RFID sans le savoir : cartes de transports, des \u00e9tiquettes antivols dans les magasins, des badges de s\u00e9curit\u00e9 ou plus r\u00e9cemment des cl\u00e9s sans contact pour voiture. Cette technologie a pour avantager de faire gagner du temps aux usagers et de permettre une lecture rapide des donn\u00e9es. La RFID est une m\u00e9thode qui permet de m\u00e9moriser et r\u00e9cup\u00e9rer des donn\u00e9es \u00e0 distance . Le syst\u00e8me est activ\u00e9 par un transfert d\u2019\u00e9nergie \u00e9lectromagn\u00e9tique entre une \u00e9tiquette radio (passive le plus souvent) et un \u00e9metteur RFID (actif). L\u2019\u00e9tiquette radio, compos\u00e9e d\u2019une puce \u00e9lectronique et d\u2019une antenne, re\u00e7oit le signal radio \u00e9mis par le lecteur RFID. Les composants permettent \u00e0 la fois de lire et de r\u00e9pondre aux signaux. Exemples concrets \u2693\ufe0e Tokyo et la Pub \u2693\ufe0e A Tokyo, plus de 10 000 Marqueurs RFID ont \u00e9t\u00e9 install\u00e9s dans les rues afin d\u2019informer les pi\u00e9tons lors de leurs d\u00e9placements ou encore pour envoyer certaines promotions cibl\u00e9es dans la rue. Info Ce projet \u00e9tait un test. Il a \u00e9t\u00e9 fait dans le respect des donn\u00e9es personnelles des utilisateurs. Paris et les Arbres \u2693\ufe0e Paris a ins\u00e9r\u00e9 des puces RFID (fiches) dans 95 000 arbres pour assurer un suivi de ces derniers. Pour lire et/ou renseigner ces fiches, les agents municipaux sont munis d\u2019un terminal nomade capable de lire les puces RFID. Par ce syst\u00e8me, Oracle met en avant une r\u00e9duction des \u00abpaperasseries et lourdeurs administratives\u00bb. Info Ces puces, ins\u00e9r\u00e9es \u00e0 2 cm de profondeur dans les troncs, se pr\u00e9sentent sous la forme d'un cylindre de 3 cm de long int\u00e9grant une seule information: le num\u00e9ro d'identification de l\u2019arbre. En passant le lecteur portable \u00e0 15 cm de distance, l\u2019agent peut acc\u00e9der \u00e0 la fiche de chaque arbre sur une base de donn\u00e9es embarqu\u00e9e. Il peut ensuite y ajouter / modifier sa date de plantation, ses arrosages, les maladies diagnostiqu\u00e9es, ou encore les \u00e9ventuels traumatismes occasionn\u00e9s notamment par les chocs de v\u00e9hicules. La base centrale est mise \u00e0 jour chaque soir lorsque les terminaux nomades se rechargent sur leurs stations d'accueil. Am\u00e9liorations du quotidien \u2693\ufe0e Pour simplifier la vie des m\u00e9nages, les entreprises ont introduits la RFID dans beaucoup d\u2019objets du quotidien tels que : les p\u00e9ages \u00e9lectroniques d\u2019autoroute (Vinci) les transports en commun (pass Navigo) les passeports biom\u00e9triques (L'Etat) le paiement sans contact... (Les banques) Lutte contre le vol et la contrefa\u00e7on \u2693\ufe0e La RFID permet \u00e9galement de lutter contre le vol \u00e0 l\u2019\u00e9talage gr\u00e2ce \u00e0 des \u00e9tiquettes antivol discr\u00e8tes \u00e0 poser directement sur le produit ou sur l\u2019emballage. La tra\u00e7abilit\u00e9 des produits \u2693\ufe0e Chez les animaux \u2693\ufe0e L\u2019une des utilisations les plus anciennes pour ce type de proc\u00e9d\u00e9 vient des ann\u00e9es 80 pour l\u2019identification et la tra\u00e7abilit\u00e9 du b\u00e9tail. La technologie RFID permet de contr\u00f4ler les animaux de leur naissance jusqu\u2019\u00e0 l\u2019abatage sans fraude, pour une meilleure tra\u00e7abilit\u00e9 pour le consommateur et l\u2019agriculteur. Aujourd\u2019hui, de plus en plus de puces sous cutan\u00e9es sont introduit sous la peau de certains animaux notamment pour une meilleure identification des animaux de compagnie (en cas de perte) ou un contr\u00f4le des animaux en voie de disparition. Dans les chaines de production et livraison \u2693\ufe0e L'\u00e9tiquette est pos\u00e9e sur le produit ou sur son emballage au cours de sa fabrication. La puce permet de tracer le produit durant son parcours : pendant le transport en avion, le stockage ou encore la mise en rayon dans un magasin. Cette technique permet d\u2019estimer au mieux le co\u00fbt et la dur\u00e9e de la cha\u00eene logistique. Aussi, cela permet d\u2019anticiper des dysfonctionnements et d\u2019obtenir un historique du produit en cas de dommages. Gestion des stocks de magasins \u2693\ufe0e On retrouve ici le picking en rayon ou la gestion des stocks dans sa globalit\u00e9. Dans les magasins et usines qui poss\u00e8dent des stocks, le tag RFID est le moyen d\u2019analyser rapidement les flux du stock jusqu\u2019\u00e0 la vente. La caisse communique avec l\u2019ordinateur mettant ainsi \u00e0 jour la liste du stock. La technologie informe de l\u2019arriv\u00e9e et de la sortie du produit. En cas de vol dans un stock, il est possible de retracer le parcours du produit. Au-del\u00e0 des stocks, les magasins peuvent \u00e9galement acc\u00e9l\u00e9rer l\u2019inventaire en boutique. Tesco \u2693\ufe0e Des entreprises telles que Tesco, une marque britannique, utilisent des robots \u00e9quip\u00e9s de lecteurs RFID pour lire les puces et faire l\u2019inventaire. Les \u00e9tiquettes RFID permettent de reconna\u00eetre un produit et d\u2019obtenir toutes ses caract\u00e9ristiques. Decathlon \u2693\ufe0e Pour optimiser au mieux sa cha\u00eene logistique, des entreprises comme D\u00e9cathlon utilisent la technologie RFID pour reconna\u00eetre les produits et les \u00e9changer sans tickets de caisse. Dans le futur \u2693\ufe0e Dans le futur, nous pourrons voir la RFID dans d\u2019autres domaines tels que la m\u00e9decine, dans les poubelles publiques, ou reli\u00e9s \u00e0 une connexion Wi-Fi. Esso a, par exemple, mis en place un syst\u00e8me qui permettrait de s\u2019approvisionner en carburant gr\u00e2ce \u00e0 un lecteur positionn\u00e9 dans sa voiture. Etc ...","title":"Introduction"},{"location":"00_intro/#introduction","text":"","title":"Introduction"},{"location":"00_intro/#objectifs","text":"Avec la croissance des produits RFID , il est important de bien comprendre comment la technologie fonctionne et comment l\u2019 utiliser de la mani\u00e8re la plus efficace. Nous allons utiliser une carte Mifare Classic 1K pour exemple. Nous allons ensuite exploiter les failles de s\u00e9curit\u00e9 de cette carte afin de hacker puis cloner la carte en question.","title":"Objectifs"},{"location":"00_intro/#rfid-ou-radio-frequency-identification","text":"Tous les jours nous utilisons des produits RFID sans le savoir : cartes de transports, des \u00e9tiquettes antivols dans les magasins, des badges de s\u00e9curit\u00e9 ou plus r\u00e9cemment des cl\u00e9s sans contact pour voiture. Cette technologie a pour avantager de faire gagner du temps aux usagers et de permettre une lecture rapide des donn\u00e9es. La RFID est une m\u00e9thode qui permet de m\u00e9moriser et r\u00e9cup\u00e9rer des donn\u00e9es \u00e0 distance . Le syst\u00e8me est activ\u00e9 par un transfert d\u2019\u00e9nergie \u00e9lectromagn\u00e9tique entre une \u00e9tiquette radio (passive le plus souvent) et un \u00e9metteur RFID (actif). L\u2019\u00e9tiquette radio, compos\u00e9e d\u2019une puce \u00e9lectronique et d\u2019une antenne, re\u00e7oit le signal radio \u00e9mis par le lecteur RFID. Les composants permettent \u00e0 la fois de lire et de r\u00e9pondre aux signaux.","title":"RFID ou Radio Frequency IDentification"},{"location":"00_intro/#exemples-concrets","text":"","title":"Exemples concrets"},{"location":"00_intro/#tokyo-et-la-pub","text":"A Tokyo, plus de 10 000 Marqueurs RFID ont \u00e9t\u00e9 install\u00e9s dans les rues afin d\u2019informer les pi\u00e9tons lors de leurs d\u00e9placements ou encore pour envoyer certaines promotions cibl\u00e9es dans la rue. Info Ce projet \u00e9tait un test. Il a \u00e9t\u00e9 fait dans le respect des donn\u00e9es personnelles des utilisateurs.","title":"Tokyo et la Pub"},{"location":"00_intro/#paris-et-les-arbres","text":"Paris a ins\u00e9r\u00e9 des puces RFID (fiches) dans 95 000 arbres pour assurer un suivi de ces derniers. Pour lire et/ou renseigner ces fiches, les agents municipaux sont munis d\u2019un terminal nomade capable de lire les puces RFID. Par ce syst\u00e8me, Oracle met en avant une r\u00e9duction des \u00abpaperasseries et lourdeurs administratives\u00bb. Info Ces puces, ins\u00e9r\u00e9es \u00e0 2 cm de profondeur dans les troncs, se pr\u00e9sentent sous la forme d'un cylindre de 3 cm de long int\u00e9grant une seule information: le num\u00e9ro d'identification de l\u2019arbre. En passant le lecteur portable \u00e0 15 cm de distance, l\u2019agent peut acc\u00e9der \u00e0 la fiche de chaque arbre sur une base de donn\u00e9es embarqu\u00e9e. Il peut ensuite y ajouter / modifier sa date de plantation, ses arrosages, les maladies diagnostiqu\u00e9es, ou encore les \u00e9ventuels traumatismes occasionn\u00e9s notamment par les chocs de v\u00e9hicules. La base centrale est mise \u00e0 jour chaque soir lorsque les terminaux nomades se rechargent sur leurs stations d'accueil.","title":"Paris et les Arbres"},{"location":"00_intro/#ameliorations-du-quotidien","text":"Pour simplifier la vie des m\u00e9nages, les entreprises ont introduits la RFID dans beaucoup d\u2019objets du quotidien tels que : les p\u00e9ages \u00e9lectroniques d\u2019autoroute (Vinci) les transports en commun (pass Navigo) les passeports biom\u00e9triques (L'Etat) le paiement sans contact... (Les banques)","title":"Am\u00e9liorations du quotidien"},{"location":"00_intro/#lutte-contre-le-vol-et-la-contrefacon","text":"La RFID permet \u00e9galement de lutter contre le vol \u00e0 l\u2019\u00e9talage gr\u00e2ce \u00e0 des \u00e9tiquettes antivol discr\u00e8tes \u00e0 poser directement sur le produit ou sur l\u2019emballage.","title":"Lutte contre le vol et la contrefa\u00e7on"},{"location":"00_intro/#la-tracabilite-des-produits","text":"","title":"La tra\u00e7abilit\u00e9 des produits"},{"location":"00_intro/#chez-les-animaux","text":"L\u2019une des utilisations les plus anciennes pour ce type de proc\u00e9d\u00e9 vient des ann\u00e9es 80 pour l\u2019identification et la tra\u00e7abilit\u00e9 du b\u00e9tail. La technologie RFID permet de contr\u00f4ler les animaux de leur naissance jusqu\u2019\u00e0 l\u2019abatage sans fraude, pour une meilleure tra\u00e7abilit\u00e9 pour le consommateur et l\u2019agriculteur. Aujourd\u2019hui, de plus en plus de puces sous cutan\u00e9es sont introduit sous la peau de certains animaux notamment pour une meilleure identification des animaux de compagnie (en cas de perte) ou un contr\u00f4le des animaux en voie de disparition.","title":"Chez les animaux"},{"location":"00_intro/#dans-les-chaines-de-production-et-livraison","text":"L'\u00e9tiquette est pos\u00e9e sur le produit ou sur son emballage au cours de sa fabrication. La puce permet de tracer le produit durant son parcours : pendant le transport en avion, le stockage ou encore la mise en rayon dans un magasin. Cette technique permet d\u2019estimer au mieux le co\u00fbt et la dur\u00e9e de la cha\u00eene logistique. Aussi, cela permet d\u2019anticiper des dysfonctionnements et d\u2019obtenir un historique du produit en cas de dommages.","title":"Dans les chaines de production et livraison"},{"location":"00_intro/#gestion-des-stocks-de-magasins","text":"On retrouve ici le picking en rayon ou la gestion des stocks dans sa globalit\u00e9. Dans les magasins et usines qui poss\u00e8dent des stocks, le tag RFID est le moyen d\u2019analyser rapidement les flux du stock jusqu\u2019\u00e0 la vente. La caisse communique avec l\u2019ordinateur mettant ainsi \u00e0 jour la liste du stock. La technologie informe de l\u2019arriv\u00e9e et de la sortie du produit. En cas de vol dans un stock, il est possible de retracer le parcours du produit. Au-del\u00e0 des stocks, les magasins peuvent \u00e9galement acc\u00e9l\u00e9rer l\u2019inventaire en boutique.","title":"Gestion des stocks de magasins"},{"location":"00_intro/#tesco","text":"Des entreprises telles que Tesco, une marque britannique, utilisent des robots \u00e9quip\u00e9s de lecteurs RFID pour lire les puces et faire l\u2019inventaire. Les \u00e9tiquettes RFID permettent de reconna\u00eetre un produit et d\u2019obtenir toutes ses caract\u00e9ristiques.","title":"Tesco"},{"location":"00_intro/#decathlon","text":"Pour optimiser au mieux sa cha\u00eene logistique, des entreprises comme D\u00e9cathlon utilisent la technologie RFID pour reconna\u00eetre les produits et les \u00e9changer sans tickets de caisse.","title":"Decathlon"},{"location":"00_intro/#dans-le-futur","text":"Dans le futur, nous pourrons voir la RFID dans d\u2019autres domaines tels que la m\u00e9decine, dans les poubelles publiques, ou reli\u00e9s \u00e0 une connexion Wi-Fi. Esso a, par exemple, mis en place un syst\u00e8me qui permettrait de s\u2019approvisionner en carburant gr\u00e2ce \u00e0 un lecteur positionn\u00e9 dans sa voiture. Etc ...","title":"Dans le futur"},{"location":"01_rfid-vs-nfc/","text":"RFID vs NFC \u2693\ufe0e NFC \u2693\ufe0e Le NFC n'est en fait qu'un standard diff\u00e9rent pour la RFID Haute Fr\u00e9quence, adapt\u00e9 aux usage des smartphones en particulier.","title":"RFID vs NFC"},{"location":"01_rfid-vs-nfc/#rfid-vs-nfc","text":"","title":"RFID vs NFC"},{"location":"01_rfid-vs-nfc/#nfc","text":"Le NFC n'est en fait qu'un standard diff\u00e9rent pour la RFID Haute Fr\u00e9quence, adapt\u00e9 aux usage des smartphones en particulier.","title":"NFC"},{"location":"02_puces-lecteurs-rfid/","text":"Puces et Lecteurs RFID \u2693\ufe0e Types de supports par usages \u2693\ufe0e Tip La liste ci-dessous n'est pas exhaustive ! Note Pour chacun de ces supports, la puce peut \u00eatre \u00e0 usage unique (lecture seule) ou bien r\u00e9inscriptible (lecture et \u00e9criture avec m\u00e9moire). Support Usage Paiement sans contact Contr\u00f4le d\u2019acc\u00e8s en entreprise Transports Cartes de fid\u00e9lit\u00e9 Stockage et inventaire Lutte contre la contrefa\u00e7on Tra\u00e7abilit\u00e9 des produits Identification des personnes Paiement sans contact Promotion dans les \u00e9v\u00e9nements Acc\u00e8s \u00e0 des r\u00e9sidences locaux et parking Badge RFID d\u2019acc\u00e8s en entreprise Identification d\u2019animaux Fr\u00e9quences utilis\u00e9es \u2693\ufe0e La fr\u00e9quence est la caract\u00e9ristique qui permet d\u2019\u00e9tablir la communication entre la puce et le lecteur. Plus la fr\u00e9quence est \u00e9lev\u00e9e , plus la distance de lecture s\u2019agrandit . En fonction de ces \u00e9l\u00e9ments, la puce sera plus ou moins puissante et plus on\u00e9reuse. Types de fr\u00e9quence Fr\u00e9quence de fonctionnement Distance de lecture (m) Taux de transfert Normes Basse fr\u00e9quence < 135 kHz 0.5 1kb/s ISO 142231 ISO 18000-2 Haute fr\u00e9quence 13,56 Mhz 1 25kb/s ISO 14443 ISO 15693 ISO 18000-3 Tr\u00e8s haute fr\u00e9quence 863 \u00e0 915 Mhz 3 \u00e0 6 28kb/s ISO 18000-6 Tip Dans ce cours nous allons utiliser des puces RFID HF. Puces Passive vs Active \u2693\ufe0e Cette technologie se d\u00e9cline en trois versions : La RFID passive : Fonctionne en lecture seule puisque la puce ne poss\u00e8de pas de batterie et doit \u00eatre d\u00e9plac\u00e9 vers le lecteur pour \u00eatre lu. Un puissant signal \u00e9lectromagn\u00e9tique lui est alors envoy\u00e9, ce qui permet d\u2019activer la puce RFID et de lire les informations qu\u2019elle contient. La RFID active : Fonctionne avec une source d\u2019\u00e9nergie telle qu\u2019une petite pile ou une batterie, ce qui permet de lire la carte \u00e0 plus longue distance. La RFID semi-passive : Tout comme la RFID active, la RFID semi-passive est aliment\u00e9 par une source d\u2019\u00e9nergie. Cependant, la batterie alimente la puce RFID \u00e0 des intervalles de temps r\u00e9guliers (\u00e9conomie d'\u00e9nergie). Celle-ci n\u2019envoie pas de signal. Lecteurs \u2693\ufe0e Pour pouvoir communiquer avec les tags RFID, il faut un lecteur fixe ou portable . Ce lecteur a pour but de lire les donn\u00e9es si elles ont \u00e9t\u00e9 enregistr\u00e9es \u00e0 leur conception ou bien de modifier le contenu si la puce le permet. Types Caract\u00e9ristiques Distance de lecture Fr\u00e9quence Fixe Sous forme de portique ou bornes notamment en caisse de supermarch\u00e9, en contr\u00f4le d\u2019acc\u00e8s, \u00e0 la biblioth\u00e8que. Proximit\u00e9 : 25cm (le plus commun) Voisinage : jusqu\u2019\u00e0 1m Moyenne distance : jusqu\u2019\u00e0 9m Longue port\u00e9e : centaines de m\u00e8tres. Basse fr\u00e9quence LF 125 Khz Haute fr\u00e9quence HF 13,56Mhz Tr\u00e8s haute fr\u00e9quence UHF 868Mhz Portable Flasher portatif pour lire les \u00e9tiquettes manuellement. Les \u00e9tiquettes n\u2019ont pas besoin d\u2019\u00eatre d\u00e9plac\u00e9es. Quelques centim\u00e8tres \u00e0 quelques m\u00e8tres Basse fr\u00e9quence LF 125 Khz Haute fr\u00e9quence HF 13,56Mhz Tr\u00e8s haute fr\u00e9quence UHF 868 Mhz","title":"Puces et Lecteurs RFID"},{"location":"02_puces-lecteurs-rfid/#puces-et-lecteurs-rfid","text":"","title":"Puces et Lecteurs RFID"},{"location":"02_puces-lecteurs-rfid/#types-de-supports-par-usages","text":"Tip La liste ci-dessous n'est pas exhaustive ! Note Pour chacun de ces supports, la puce peut \u00eatre \u00e0 usage unique (lecture seule) ou bien r\u00e9inscriptible (lecture et \u00e9criture avec m\u00e9moire). Support Usage Paiement sans contact Contr\u00f4le d\u2019acc\u00e8s en entreprise Transports Cartes de fid\u00e9lit\u00e9 Stockage et inventaire Lutte contre la contrefa\u00e7on Tra\u00e7abilit\u00e9 des produits Identification des personnes Paiement sans contact Promotion dans les \u00e9v\u00e9nements Acc\u00e8s \u00e0 des r\u00e9sidences locaux et parking Badge RFID d\u2019acc\u00e8s en entreprise Identification d\u2019animaux","title":"Types de supports par usages"},{"location":"02_puces-lecteurs-rfid/#frequences-utilisees","text":"La fr\u00e9quence est la caract\u00e9ristique qui permet d\u2019\u00e9tablir la communication entre la puce et le lecteur. Plus la fr\u00e9quence est \u00e9lev\u00e9e , plus la distance de lecture s\u2019agrandit . En fonction de ces \u00e9l\u00e9ments, la puce sera plus ou moins puissante et plus on\u00e9reuse. Types de fr\u00e9quence Fr\u00e9quence de fonctionnement Distance de lecture (m) Taux de transfert Normes Basse fr\u00e9quence < 135 kHz 0.5 1kb/s ISO 142231 ISO 18000-2 Haute fr\u00e9quence 13,56 Mhz 1 25kb/s ISO 14443 ISO 15693 ISO 18000-3 Tr\u00e8s haute fr\u00e9quence 863 \u00e0 915 Mhz 3 \u00e0 6 28kb/s ISO 18000-6 Tip Dans ce cours nous allons utiliser des puces RFID HF.","title":"Fr\u00e9quences utilis\u00e9es"},{"location":"02_puces-lecteurs-rfid/#puces-passive-vs-active","text":"Cette technologie se d\u00e9cline en trois versions : La RFID passive : Fonctionne en lecture seule puisque la puce ne poss\u00e8de pas de batterie et doit \u00eatre d\u00e9plac\u00e9 vers le lecteur pour \u00eatre lu. Un puissant signal \u00e9lectromagn\u00e9tique lui est alors envoy\u00e9, ce qui permet d\u2019activer la puce RFID et de lire les informations qu\u2019elle contient. La RFID active : Fonctionne avec une source d\u2019\u00e9nergie telle qu\u2019une petite pile ou une batterie, ce qui permet de lire la carte \u00e0 plus longue distance. La RFID semi-passive : Tout comme la RFID active, la RFID semi-passive est aliment\u00e9 par une source d\u2019\u00e9nergie. Cependant, la batterie alimente la puce RFID \u00e0 des intervalles de temps r\u00e9guliers (\u00e9conomie d'\u00e9nergie). Celle-ci n\u2019envoie pas de signal.","title":"Puces Passive vs Active"},{"location":"02_puces-lecteurs-rfid/#lecteurs","text":"Pour pouvoir communiquer avec les tags RFID, il faut un lecteur fixe ou portable . Ce lecteur a pour but de lire les donn\u00e9es si elles ont \u00e9t\u00e9 enregistr\u00e9es \u00e0 leur conception ou bien de modifier le contenu si la puce le permet. Types Caract\u00e9ristiques Distance de lecture Fr\u00e9quence Fixe Sous forme de portique ou bornes notamment en caisse de supermarch\u00e9, en contr\u00f4le d\u2019acc\u00e8s, \u00e0 la biblioth\u00e8que. Proximit\u00e9 : 25cm (le plus commun) Voisinage : jusqu\u2019\u00e0 1m Moyenne distance : jusqu\u2019\u00e0 9m Longue port\u00e9e : centaines de m\u00e8tres. Basse fr\u00e9quence LF 125 Khz Haute fr\u00e9quence HF 13,56Mhz Tr\u00e8s haute fr\u00e9quence UHF 868Mhz Portable Flasher portatif pour lire les \u00e9tiquettes manuellement. Les \u00e9tiquettes n\u2019ont pas besoin d\u2019\u00eatre d\u00e9plac\u00e9es. Quelques centim\u00e8tres \u00e0 quelques m\u00e8tres Basse fr\u00e9quence LF 125 Khz Haute fr\u00e9quence HF 13,56Mhz Tr\u00e8s haute fr\u00e9quence UHF 868 Mhz","title":"Lecteurs"},{"location":"04_limites-rfid/","text":"Limites du RFID \u2693\ufe0e Comme toute technologie, la RFID poss\u00e8de ses propres limites. La diffusion de l\u2019information pose probl\u00e8me pour toutes les questions sur la s\u00e9curit\u00e9 de la vie priv\u00e9e . Warning Une carte non s\u00e9curis\u00e9e peut \u00eatre facilement copi\u00e9e pour r\u00e9cup\u00e9rer ou modifier les donn\u00e9es sensibles. De ce fait, il est n\u00e9cessaire d\u2019apporter plus de s\u00e9curit\u00e9 : Prot\u00e9ger les cartes et badges RFID d\u2019acc\u00e8s gr\u00e2ce \u00e0 des \u00e9tuis de protection emp\u00eachant la r\u00e9cup\u00e9ration des donn\u00e9es Limiter la dur\u00e9e de vie des donn\u00e9es enregistr\u00e9es sur les cartes RFID (La carte Navigo ne donne que les trois derni\u00e8res stations pour ne pas tracer les individus et \u00e9viter la fraude) Chiffrer ou coder les donn\u00e9es pour ne pas risquer de divulguer des informations sensibles telles que des informations d\u2019identit\u00e9s, des donn\u00e9es bancaires\u2026 Pour permettre l\u2019identification d\u2019une carte, associer une photo pour reconna\u00eetre le propri\u00e9taire de la carte ou imprimer un hologramme pour authentifier la carte. Aussi, toutes les puces ne sont pas lisibles \u00e0 la m\u00eame distance et dans les m\u00eames conditions. La transmission des ondes est limit\u00e9e \u00e0 travers certains murs et certains m\u00e9taux.","title":"Limites du RFID"},{"location":"04_limites-rfid/#limites-du-rfid","text":"Comme toute technologie, la RFID poss\u00e8de ses propres limites. La diffusion de l\u2019information pose probl\u00e8me pour toutes les questions sur la s\u00e9curit\u00e9 de la vie priv\u00e9e . Warning Une carte non s\u00e9curis\u00e9e peut \u00eatre facilement copi\u00e9e pour r\u00e9cup\u00e9rer ou modifier les donn\u00e9es sensibles. De ce fait, il est n\u00e9cessaire d\u2019apporter plus de s\u00e9curit\u00e9 : Prot\u00e9ger les cartes et badges RFID d\u2019acc\u00e8s gr\u00e2ce \u00e0 des \u00e9tuis de protection emp\u00eachant la r\u00e9cup\u00e9ration des donn\u00e9es Limiter la dur\u00e9e de vie des donn\u00e9es enregistr\u00e9es sur les cartes RFID (La carte Navigo ne donne que les trois derni\u00e8res stations pour ne pas tracer les individus et \u00e9viter la fraude) Chiffrer ou coder les donn\u00e9es pour ne pas risquer de divulguer des informations sensibles telles que des informations d\u2019identit\u00e9s, des donn\u00e9es bancaires\u2026 Pour permettre l\u2019identification d\u2019une carte, associer une photo pour reconna\u00eetre le propri\u00e9taire de la carte ou imprimer un hologramme pour authentifier la carte. Aussi, toutes les puces ne sont pas lisibles \u00e0 la m\u00eame distance et dans les m\u00eames conditions. La transmission des ondes est limit\u00e9e \u00e0 travers certains murs et certains m\u00e9taux.","title":"Limites du RFID"},{"location":"05_mifare-classic-1k/","text":"Etude - MIFARE Classic 1K \u2693\ufe0e Mifare produit la majorit\u00e9 des cartes \u00e0 puce et RFID . Nous allons observer la Mifare Classic 1K, car elle est ancienne et poss\u00e8de quelques failles de s\u00e9curit\u00e9 \u00e0 exploiter. Warning Malgr\u00e8s cela elle reste tr\u00e8s r\u00e9pandue dans le march\u00e9 de la RFID low cost ... UID \u2693\ufe0e Tous les badges et cartes Mifare poss\u00e8dent un identifiant : le NUID (Non Unique ID) Il est cod\u00e9 sur 4 Bytes. Info Certaines cartes MiFare plus \u00e9volu\u00e9es poss\u00e8dent un UID (Unique ID) cod\u00e9 sur 7 Bytes. Structure g\u00e9n\u00e9rale \u2693\ufe0e Il est important de connaitre l'organisation de la m\u00e9moire d'une carte pour esp\u00e9rer pouvoir exploiter ses failles. Une Mifare 1K se d\u00e9compose ainsi : 1024 Bytes au total , d'ou son nom. Coup\u00e9s en 16 Sectors (0-15) Chaque Sector se compose de 4 Blocks Chaque block contient 16 Bytes Info 4 * 16 * 16 = 1024 ! Manufacturer Block \u2693\ufe0e Il s'agit du premier bloc de donn\u00e9es (bloc 0) du premier secteur (secteur 0). Il contient les donn\u00e9es du fabricant, mais surtout l' UID de la carte. Warning Ce bloc est programm\u00e9 et prot\u00e9g\u00e9 en \u00e9criture dans le test de production. Tip Il existe des cartes chinoises appel\u00e9es \"Magic Cards\" , dont le bloc 0 est accessible en \u00e9criture ... Cela permet de cloner des cartes ! Data Block \u2693\ufe0e Block permettant de stocker des donn\u00e9es brutes. Leur codage est libre. Value Block \u2693\ufe0e Block permettant de stocker de mani\u00e8re s\u00e9curis\u00e9e des donn\u00e9es de type Integer. Leur codage fix\u00e9 permet la detection d'erreur, leur correction et restoration. Ils sont utilis\u00e9s notamment dans les porte-feuils \u00e9lectroniques. Acc\u00e8s M\u00e9moire \u2693\ufe0e Avant toute op\u00e9ration de m\u00e9moire, la carte doit \u00eatre s\u00e9lectionn\u00e9e et authentifi\u00e9e . Les op\u00e9rations de m\u00e9moire possibles pour un bloc adress\u00e9 d\u00e9pendent de la cl\u00e9 utilis\u00e9e lors de l'authentification et des access conditions stock\u00e9es dans le sector trailer associ\u00e9. Sector Trailer \u2693\ufe0e C'est le 4\u00e8me Block de chaque Secteur . Dans ce Block on retrouve les 2 cl\u00e9s A et B . - A sur les 6 premiers octets - B sur les 6 denriers octets Les cl\u00e9s A et B r\u00e9gissent l'acc\u00e8s aux diff\u00e9rentes parties de la m\u00e9moire, par secteur. Il y a donc une gestion de l'authentification sur ces cartes. Les 4 octets du milieux sont les Access Bits . Tip Par defaut, les cl\u00e9s A et B sont \u00e0 la valeur : FF FF FF FF FF FF Access Bits \u2693\ufe0e Ce sont les octets 6, 7, 8 et 9 d'un Sector Trailer Block. Seules les bits 6, 7 et 8 sont utilis\u00e9s pour coder les conditions d'acces des block 0, 1, et 2. L'octet 9 est libre d'acc\u00e8s \u00e0 l'utilisateur. Tip Par defaut, les access bits sont \u00e0 la valeur FF 07 80 Le codage des access bit ne sera pas d\u00e9crit ici car trop complexe, mais peut \u00eatre trouv\u00e9 dans la Documentation de la Mifare Classic 1K .","title":"Etude - MIFARE Classic 1K"},{"location":"05_mifare-classic-1k/#etude-mifare-classic-1k","text":"Mifare produit la majorit\u00e9 des cartes \u00e0 puce et RFID . Nous allons observer la Mifare Classic 1K, car elle est ancienne et poss\u00e8de quelques failles de s\u00e9curit\u00e9 \u00e0 exploiter. Warning Malgr\u00e8s cela elle reste tr\u00e8s r\u00e9pandue dans le march\u00e9 de la RFID low cost ...","title":"Etude - MIFARE Classic 1K"},{"location":"05_mifare-classic-1k/#uid","text":"Tous les badges et cartes Mifare poss\u00e8dent un identifiant : le NUID (Non Unique ID) Il est cod\u00e9 sur 4 Bytes. Info Certaines cartes MiFare plus \u00e9volu\u00e9es poss\u00e8dent un UID (Unique ID) cod\u00e9 sur 7 Bytes.","title":"UID"},{"location":"05_mifare-classic-1k/#structure-generale","text":"Il est important de connaitre l'organisation de la m\u00e9moire d'une carte pour esp\u00e9rer pouvoir exploiter ses failles. Une Mifare 1K se d\u00e9compose ainsi : 1024 Bytes au total , d'ou son nom. Coup\u00e9s en 16 Sectors (0-15) Chaque Sector se compose de 4 Blocks Chaque block contient 16 Bytes Info 4 * 16 * 16 = 1024 !","title":"Structure g\u00e9n\u00e9rale"},{"location":"05_mifare-classic-1k/#manufacturer-block","text":"Il s'agit du premier bloc de donn\u00e9es (bloc 0) du premier secteur (secteur 0). Il contient les donn\u00e9es du fabricant, mais surtout l' UID de la carte. Warning Ce bloc est programm\u00e9 et prot\u00e9g\u00e9 en \u00e9criture dans le test de production. Tip Il existe des cartes chinoises appel\u00e9es \"Magic Cards\" , dont le bloc 0 est accessible en \u00e9criture ... Cela permet de cloner des cartes !","title":"Manufacturer Block"},{"location":"05_mifare-classic-1k/#data-block","text":"Block permettant de stocker des donn\u00e9es brutes. Leur codage est libre.","title":"Data Block"},{"location":"05_mifare-classic-1k/#value-block","text":"Block permettant de stocker de mani\u00e8re s\u00e9curis\u00e9e des donn\u00e9es de type Integer. Leur codage fix\u00e9 permet la detection d'erreur, leur correction et restoration. Ils sont utilis\u00e9s notamment dans les porte-feuils \u00e9lectroniques.","title":"Value Block"},{"location":"05_mifare-classic-1k/#acces-memoire","text":"Avant toute op\u00e9ration de m\u00e9moire, la carte doit \u00eatre s\u00e9lectionn\u00e9e et authentifi\u00e9e . Les op\u00e9rations de m\u00e9moire possibles pour un bloc adress\u00e9 d\u00e9pendent de la cl\u00e9 utilis\u00e9e lors de l'authentification et des access conditions stock\u00e9es dans le sector trailer associ\u00e9.","title":"Acc\u00e8s M\u00e9moire"},{"location":"05_mifare-classic-1k/#sector-trailer","text":"C'est le 4\u00e8me Block de chaque Secteur . Dans ce Block on retrouve les 2 cl\u00e9s A et B . - A sur les 6 premiers octets - B sur les 6 denriers octets Les cl\u00e9s A et B r\u00e9gissent l'acc\u00e8s aux diff\u00e9rentes parties de la m\u00e9moire, par secteur. Il y a donc une gestion de l'authentification sur ces cartes. Les 4 octets du milieux sont les Access Bits . Tip Par defaut, les cl\u00e9s A et B sont \u00e0 la valeur : FF FF FF FF FF FF","title":"Sector Trailer"},{"location":"05_mifare-classic-1k/#access-bits","text":"Ce sont les octets 6, 7, 8 et 9 d'un Sector Trailer Block. Seules les bits 6, 7 et 8 sont utilis\u00e9s pour coder les conditions d'acces des block 0, 1, et 2. L'octet 9 est libre d'acc\u00e8s \u00e0 l'utilisateur. Tip Par defaut, les access bits sont \u00e0 la valeur FF 07 80 Le codage des access bit ne sera pas d\u00e9crit ici car trop complexe, mais peut \u00eatre trouv\u00e9 dans la Documentation de la Mifare Classic 1K .","title":"Access Bits"},{"location":"06_mifare-classic-1k-hacking/","text":"TP - MIFARE Classic 1K Ethical Hacking \u2693\ufe0e Lecture / Ecriture avec Cl\u00e9 connue (ACR122u) \u2693\ufe0e Le ACR122u est un lecteur graveur de tag RFID, le seul respectant tous les standards actuellement en vigueur. Nous allons l'utiliser pour lire et \u00e9crire des blocks de donn\u00e9es sur une carte dont nous connaissons la Key A . Ce lecteur vient avec son propre SDK et coute entre 25\u20ac et 30\u20ac. ` Parallels Desktop Pour connecter le lecteur, il faut aller dans les param\u00e8tres de Parallel Desktop : > USB & Bluetooth > Share smart card readers with windows Le d\u00e9cocher puis le recocher. ACR122u Tool - UID \u2693\ufe0e Connecter le lecteur au PC Ouvrir le logiciel `ACS SMart Card Reader Selectionner : Smart Cards > MIFARE SERIES > Mifare Classic > Mifare Classic Card Tool La LED du lecteur est rouge Poser le badge Bleu 1 sur le lecteur, la LED devient verte Pour connecter le lecteur cliquer sur : New Connection > PC/SC Connection R\u00e9cup\u00e9rer l'UID de la carte : Card UUID ACR122u Tool - ATR \u2693\ufe0e Comme sur une smart card, on voit l'ATR (Answer To Reset) passer quand on pose le badge sur le lecteur. Cela nous donnera l'acc\u00e8s aux commandes cartes. Il faut maintenant Charger les Cl\u00e9s dans le lecteur : Load Key > Key Structure : 00 / Key Number : 00 / Key > FF FF FF FF FF FF (Default Transport Configuration pour toute nouvelle carte) Load Key > Key Structure : 00 / Key Number : 01 / Key > FF FF FF FF AA 01 (Cl\u00e9 A modifi\u00e9e du secteur 1). Load Key > Key Structure : 00 / Key Number : 02 / Key > FF FF FF FF BB 01 (Cl\u00e9 B modifi\u00e9e du secteur 1). Puis on peut s'authentifier sur le block de notre choix : block 0x00 , avec la Cl\u00e9 A n\u00b0 0x00 provisionn\u00e9e au dessus. On peut enfin lire le block 0 (en HEX) sur une longueur de 0xOF et retrouver notre UID ! On peut lire les blocks 1 et 2, ils ne contiennent que des 0. On peut aussi lire le block 3 qui est le sector trailer du secteur 0. ACR122u Tool - Read / Write Data Block in Sector 1 \u2693\ufe0e Authenticate sur block 4 Ecrire & Lire le block 4 (Peut \u00eatre d\u00e9cod\u00e9 en ASCII) S'authentifier sur block 5 Ecrire & Lire le block 5 (Peut \u00eatre d\u00e9cod\u00e9 en ASCII) Warning Pour lire, il faut sp\u00e9cifie une longueur > 0 Pour \u00e9crire, il faut \u00e9crire TOUT le bloc (Longueur 16 Octets donc `0x10) Tip Le num\u00e9ro du block doit \u00eatre mis en HEX . Si on veut le block 11 , il faut mettre 0x0B . ACR122u Tool - Read / Write Sector Trailer \u2693\ufe0e S'authentifier sur block 3 Essayer de lire le block 3. Tip On remarque que la `cl\u00e9 A ne peut pas \u00eatre lue, on r\u00e9cup\u00e8re 00 00 00 00 00 00 Et on ne pourra jamais la lire sur une Mifare, il faut obligatoirement que le lecteur la connaisse au pr\u00e9alable ! Tip Pour modifier les cl\u00e9s facilement, il faut utiliser \"Easy Key\" . Utiliser Easy Key pour changer la cl\u00e9 A S'authentifier avec la Cl\u00e9 A : FF FF FF FF FF FF sur le sector 1 Updater la Cl\u00e9 A du Sector 1 en : FF FF FF FF AA 01 , puis cliquer sur Format Sector Tip Le bloc num\u00e9ro 3 du sector est updat\u00e9 automatiquement car c'est le Sector Trailer ! S'authentifier en utilisant la nouvelle cl\u00e9 sur le secteur 1 Modifier la cl\u00e9 B en ; FF FF FF FF BB 01 Tip On pourrait aussi modifier les Access Bits ... Verifier ces changements en essayant de lire les blocks 5 ou 6 avec les anciennes cl\u00e9s. Cela devrait \u00e9chouer. Le block 8 devrait fonctionner car il appartient au secteur 2 que nous n'avons pas modifi\u00e9. Charger les nouvelles cl\u00e9s et s'authentifier avec. Verifier que l'on peut maintenant lire les `blocks 4 & 5. Hack de Cl\u00e9s (Proxmark3) \u2693\ufe0e Le Proxmark 3 est un outil qui permet des tests de penetration, du clonage et de la simulation de tag RFID. Il co\u00fbte environ 40\u20ac en Chine mais plus de 150\u20ac en Europe ... Il vient avec le logiciel proxmark3 qui lui est open source. Documentation Officielle PM3 Source utile . DISCLAIMER Dans ce cours nous ne hackerons que des cartes/badges personnelles dont nous avons nous m\u00eame crypt\u00e9 les donn\u00e9es ! Nous sommes des \"White Hats\" ! Tip Pour les besoins de ce cours j'ai flash\u00e9 le firmware modifi\u00e9 du developer \"Iceman\" ;) Iceman repo Pour utiliser le client `pm3 de Iceman : 1 2 3 \u276f pm3 ou \u276f proxmark3 /dev/tty.usbmodemiceman1 Trouver la fr\u00e9quence d'un badge inconnu \u2693\ufe0e Il existe trois commandes principales : hw : pour l\u2019envoi de commandes hardware au Proxmark 3 ; lf et hf : pour manipuler la basse et la haute fr\u00e9quence. Tentons de d\u00e9tecter la fr\u00e9quence de fonctionnement d\u2019une carte NFC inconnue. Il existe une fonction dans le Proxmark 3 qui mesure la chute de tension induite dans l\u2019antenne lorsqu\u2019un tag s\u2019alimente. La commande hw tune renseigne les tensions pr\u00e9sentes dans les deux antennes (basse et haute fr\u00e9quences). Tip Si nous lan\u00e7ons le client avec le support Qt5, la commande tracera \u00e9galement une courbe de tension de l\u2019antenne basse fr\u00e9quence en fonction de la fr\u00e9quence utilis\u00e9e, montrant ainsi \u00e0 quelle fr\u00e9quence l\u2019antenne LF fonctionne de mani\u00e8re optimale. Si on mesure les tensions pr\u00e9sentes avant et apr\u00e8s l\u2019approche du tag sur les antennes haute et basse fr\u00e9quences, on observera une chute importante de la tension \u00e0 la fr\u00e9quence de fonctionnement du tag. Sans la carte : 1 2 3 4 5 6 7 8 9 10 11 12 13 [ usb ] pm3 --> hw tune [=] Measuring antenna characteristics, please wait... \ud83d\udd5a 10 [ + ] LF antenna: 40 .15 V - 125 .00 kHz [ + ] LF antenna: 34 .79 V - 134 .83 kHz [ + ] LF optimal: 42 .62 V - 127 .66 kHz [ + ] LF antenna is OK [ + ] HF antenna: 36 .26 V - 13 .56 MHz [ + ] HF antenna is OK [ + ] Displaying LF tuning graph. Divisor 88 is 134 .83 kHz, 95 is 125 .00 kHz. Avec la carte : 1 2 3 4 5 6 7 8 9 10 11 12 13 [ usb ] pm3 --> hw tune [=] Measuring antenna characteristics, please wait... \ud83d\udd56 10 [ + ] LF antenna: 40 .29 V - 125 .00 kHz [ + ] LF antenna: 34 .92 V - 134 .83 kHz [ + ] LF optimal: 42 .62 V - 127 .66 kHz [ + ] LF antenna is OK [ + ] HF antenna: 32 .76 V - 13 .56 MHz [ + ] HF antenna is OK [ + ] Displaying LF tuning graph. Divisor 88 is 134 .83 kHz, 95 is 125 .00 kHz. On voit que la tension a chut\u00e9 \u00e0 32.76 V lorsque l\u2019antenne haute fr\u00e9quence fonctionnait \u00e0 13.56 kHz . Dans le cas pr\u00e9sent, nous constatons donc que la carte inconnue fonctionne \u00e0 13.56 kHz . Tip C'est plus difficile \u00e0 voir avec un badge, car l'antenne est beaucoup plus petit. Dans mes essais, je n'ai pas not\u00e9 de diff\u00e9rence de voltage du tout avec le badge ... Default Keys Attack \u2693\ufe0e Cette attaque est simple, elle consiste \u00e0 v\u00e9rifier toutes les cl\u00e9s par d\u00e9faut des diff\u00e9rents constructeurs les une \u00e0 la suite des autres afin de trouver des secteurs qui les utilisent. Ce sera notre point d'entr\u00e9e pour la suite. Tip C'est un mini-bruteforce ! Nous utilisons la carte avec les cl\u00e9s modifi\u00e9es sur le secteur 1. 1 2 [ usb ] pm3 --> hf 14a info [ usb ] pm3 --> hf mf chk *1 ? t Success Tous les secteurs qui utilisent les cl\u00e9s par d\u00e9faut sont d\u00e9sormais accessibles, sauf notre secteur 1 qui r\u00e9siste encore. Nested Attack \u2693\ufe0e L'\u00e9tape pr\u00e9cedente nous offre la possibilit\u00e9 de s'authentifier sur un ou plusieurs secteurs du badge avec les cl\u00e9s par d\u00e9faut. Cela nous ouvre les portes de la Nested Attack (De l'interieur). Info Le mifare classic 1k a un g\u00e9n\u00e9rateur de nombres al\u00e9atoires faible (RNG) qui est essentiellement un registre \u00e0 d\u00e9calage. Sa faiblesse vient de la possibilit\u00e9 de restaurer le nonce 1 g\u00e9n\u00e9r\u00e9 de 32 bits. Si nous nous authentifions plusieurs fois avec une cl\u00e9 connue, nous pouvons trouver le nombre m\u00e9dian de d\u00e9calages et deviner assez pr\u00e9cis\u00e9ment le nonce non crypt\u00e9 en annulant le nonce crypt\u00e9 (nous nous sommes d\u00e9j\u00e0 authentifi\u00e9s et nous connaissons le cryptage). Puisque ce nonce est initialis\u00e9 par la cl\u00e9 sym\u00e9trique XOR avec l'UID de la carte, nous pouvons effectivement trouver 32 bits de la cl\u00e9 de 48 bits. 1 [ usb ] pm3 --> hf mf nested 1 0 A FFFFFFFFFFFF t Success La/les cl\u00e9s manquantes sont trouv\u00e9es ! On peut lire le secteur : 1 [ usb ] pm3 --> hf mf rdsc 1 A ffffffffaa01 Danger Pour se prot\u00e9ger de ses 2 attaques il faut donc syst\u00e9matiquement modifier TOUTES les cl\u00e9s de TOUS les secteurs !! Darkside Attack \u2693\ufe0e Tip Utiliser le badge jaune avec toutes les cl\u00e9s modifi\u00e9es (Cl\u00e9s : FF FF FF FF AA/BB <0xSectorNb>) ! Les manipulations ci-dessus n\u2019ont \u00e9t\u00e9 possibles que parce que nous avons d\u00e9couvert une cl\u00e9 par d\u00e9faut omise par les administrateurs des \u00e9quipements. L\u2019attaque dite Darkside ou de Courtois, du nom de son d\u00e9couvreur Nicolas Courtois, va tenter de retrouver une cl\u00e9 configur\u00e9e dans un tag en exploitant un d\u00e9faut dans l\u2019initialisation du g\u00e9n\u00e9rateur de nombres al\u00e9atoires du microcontr\u00f4leur du tag (le g\u00e9n\u00e9rateur commence toujours par la m\u00eame valeur lorsque la carte est aliment\u00e9e, donc si on contr\u00f4le finement le timing, on pr\u00e9dit le nombre al\u00e9atoire tir\u00e9 par le tag). D\u00e8s qu\u2019une premi\u00e8re cl\u00e9 est d\u00e9couverte, il sera alors possible de passer \u00e0 l\u2019attaque Nested. 1 [ usb ] pm3 --> hf mf darkside help Warn Ici aussi, si le tag MIFARE est trop r\u00e9cent, l\u2019attaque \u00e9chouera et on devra recourir \u00e0 d\u2019autres types d\u2019attaques. Success Nous avons trouv\u00e9 au moins une cl\u00e9 ! On peut donc utiliser une attaque nested pour trouver toute les autres :) Man-in-the-Middle Attack \u2693\ufe0e Si la carte a r\u00e9sist\u00e9 aux attaques pr\u00e9cedentes, il faut sniffer la communication entre le lecteur et le carte. Une fois l'\u00e9change de cl\u00e9s identifi\u00e9, il faut utiliser l'outils CRAPTO1 , qui permet de cracker le code CRYPTO1 utilis\u00e9 par MiFare et d\u00e9coder la cl\u00e9 utilis\u00e9e ... Tip Le firmware iceman fait tout \u00e7a pour nous automatiquement ;) Pour l'attaque MIM, il nous faut avoir au lecteur l\u00e9gitime et au badge. Pour simuler l'authentification aupr\u00e8s du lecteur, j'ai \u00e9crit un programme JAVA dans la classe Acr122Manager.java . Brancher l'ACR122U au PC Lancer le programme d'authentification Brancher le PM3 Dans le client PM3 : hf 14a sniff pour d\u00e9clencher l'espionnage Coller le badge au PM3 et approcher le tout du lecteur plusieurs fois pour enregistrer plusieurs trames d'authentification. Appuyer sur le bouton du PM3 pour arreter le sniff. Dans le client PM3 : hf mf list pour d\u00e9coder les trames ... Success TADAA, on a directement la cl\u00e9 d\u00e9cod\u00e9e par l'outil, qui a css\u00e9 le code CRYPTO01 pour nous :) On peut de nouveau utiliser l'attaque nested pour trouver les autres secteurs :) HardNested Attack \u2693\ufe0e Les tags MIFARE Classic r\u00e9cents ainsi que les MIFARE Plus SL1 sont plus robustes, car le g\u00e9n\u00e9rateur de nombres al\u00e9atoires et d\u2019autres d\u00e9fauts ont \u00e9t\u00e9 corrig\u00e9s. Mais ce ne sont pas les attaques contre la MIFARE qui manquent et une nouvelle attaque du type Card-Only existe, appel\u00e9e HardNested (pour Nested sur les cartes Hardened, durcies). Depuis la version 3.0.1 de Proxmark 3, l\u2019attaque HardNested est disponible dans le d\u00e9p\u00f4t principal (et iceman). Cette attaque va retrouver une cl\u00e9 dans les m\u00eames conditions que l\u2019attaque Nested, mais sur un tag r\u00e9cent, MIFARE Classic New Generation ou MIFARE Plus SL1. On lancera l\u2019attaque avec la commande hf mf hardnested 4 B xxxxxxxxxxxxx 0 B Tip Les arguments 4 , B et xxxxxxxxxxxxx correspondent \u00e0 une cl\u00e9 connue de notre badge, 0 et B la zone prot\u00e9g\u00e9e par la cl\u00e9 B que l\u2019on souhaite retrouver. Info Cette attaque met seulement 10 minutes maximum pour aboutir \u00e0 un r\u00e9sultat. Des d\u00e9tails peuvent \u00eatres trouv\u00e9s ici . BruteForce Attack \u2693\ufe0e Dans tous les cas, on peut aussi tester toutes les combinaison possible de cl\u00e9 jusqu'\u00e0 en trouver une .... puis appliquer une Nested Attack. R\u00e9sultat en 2 jours garantis avec les rainbow tables et le firmware adapt\u00e9s ... Danger Les outils d'attaque par bruteforce sont par d\u00e9faut en dehors du cadre l\u00e9gal, nous ne le verrons pas dans ce cours ... Vous pouvez chercher personnellement dans la direction du firmware proxbrute ;) Clonage \u2693\ufe0e Sur le badge a cloner : 1 2 [ usb ] pm3 --> hf mf nested 1 0 A FFFFFFFFFFFF d [ usb ] pm3 --> hf mf dump Sur un badge avec Chinese Backdoor (Pour pouvoir modifier l'UID) : 1 [ usb ] pm3 --> hf mf restore 1 <ID du badge source> Tip La modif de l'UID est faite automatiquement avec le firmware iceman ... sinon il suffit de faire hf mf csetuid <ID du badge source> Success Nous avons hack\u00e9 notre badge et toutes ses cl\u00e9s, puis dupliqu\u00e9 celui-ci en une copie intra\u00e7able :) Conclusion \u2693\ufe0e Nous avons vu plusieurs cas d\u2019attaques possibles sur des tags RFID tr\u00e8s largement r\u00e9pandus dans le monde. De nombreux tags d\u2019ancienne technologie sont toujours disponibles \u00e0 la vente et encore largement en circulation, ce qui repr\u00e9sente un danger pour l'utilisateur non averti ! Heureusement, il existe d\u2019autres protocoles MIFARE, plus s\u00e9curis\u00e9s dans leurs \u00e9changes comme ceux des MIFARE Plus SL2 et SL3 qui impl\u00e9mentent la m\u00e9thode de chiffrement AES 128-bit et MIFARE DESFire qui impl\u00e9mente du 3DES et de l\u2019AES. En cryptographie, un nonce est un nombre arbitraire destin\u00e9 \u00e0 \u00eatre utilis\u00e9 une seule fois, souvent al\u00e9atoire. \u21a9","title":"TP - MC 1K Ethical Hacking"},{"location":"06_mifare-classic-1k-hacking/#tp-mifare-classic-1k-ethical-hacking","text":"","title":"TP - MIFARE Classic 1K Ethical Hacking"},{"location":"06_mifare-classic-1k-hacking/#lecture-ecriture-avec-cle-connue-acr122u","text":"Le ACR122u est un lecteur graveur de tag RFID, le seul respectant tous les standards actuellement en vigueur. Nous allons l'utiliser pour lire et \u00e9crire des blocks de donn\u00e9es sur une carte dont nous connaissons la Key A . Ce lecteur vient avec son propre SDK et coute entre 25\u20ac et 30\u20ac. ` Parallels Desktop Pour connecter le lecteur, il faut aller dans les param\u00e8tres de Parallel Desktop : > USB & Bluetooth > Share smart card readers with windows Le d\u00e9cocher puis le recocher.","title":"Lecture / Ecriture avec Cl\u00e9 connue (ACR122u)"},{"location":"06_mifare-classic-1k-hacking/#acr122u-tool-uid","text":"Connecter le lecteur au PC Ouvrir le logiciel `ACS SMart Card Reader Selectionner : Smart Cards > MIFARE SERIES > Mifare Classic > Mifare Classic Card Tool La LED du lecteur est rouge Poser le badge Bleu 1 sur le lecteur, la LED devient verte Pour connecter le lecteur cliquer sur : New Connection > PC/SC Connection R\u00e9cup\u00e9rer l'UID de la carte : Card UUID","title":"ACR122u Tool - UID"},{"location":"06_mifare-classic-1k-hacking/#acr122u-tool-atr","text":"Comme sur une smart card, on voit l'ATR (Answer To Reset) passer quand on pose le badge sur le lecteur. Cela nous donnera l'acc\u00e8s aux commandes cartes. Il faut maintenant Charger les Cl\u00e9s dans le lecteur : Load Key > Key Structure : 00 / Key Number : 00 / Key > FF FF FF FF FF FF (Default Transport Configuration pour toute nouvelle carte) Load Key > Key Structure : 00 / Key Number : 01 / Key > FF FF FF FF AA 01 (Cl\u00e9 A modifi\u00e9e du secteur 1). Load Key > Key Structure : 00 / Key Number : 02 / Key > FF FF FF FF BB 01 (Cl\u00e9 B modifi\u00e9e du secteur 1). Puis on peut s'authentifier sur le block de notre choix : block 0x00 , avec la Cl\u00e9 A n\u00b0 0x00 provisionn\u00e9e au dessus. On peut enfin lire le block 0 (en HEX) sur une longueur de 0xOF et retrouver notre UID ! On peut lire les blocks 1 et 2, ils ne contiennent que des 0. On peut aussi lire le block 3 qui est le sector trailer du secteur 0.","title":"ACR122u Tool - ATR"},{"location":"06_mifare-classic-1k-hacking/#acr122u-tool-read-write-data-block-in-sector-1","text":"Authenticate sur block 4 Ecrire & Lire le block 4 (Peut \u00eatre d\u00e9cod\u00e9 en ASCII) S'authentifier sur block 5 Ecrire & Lire le block 5 (Peut \u00eatre d\u00e9cod\u00e9 en ASCII) Warning Pour lire, il faut sp\u00e9cifie une longueur > 0 Pour \u00e9crire, il faut \u00e9crire TOUT le bloc (Longueur 16 Octets donc `0x10) Tip Le num\u00e9ro du block doit \u00eatre mis en HEX . Si on veut le block 11 , il faut mettre 0x0B .","title":"ACR122u Tool - Read / Write Data Block in Sector 1"},{"location":"06_mifare-classic-1k-hacking/#acr122u-tool-read-write-sector-trailer","text":"S'authentifier sur block 3 Essayer de lire le block 3. Tip On remarque que la `cl\u00e9 A ne peut pas \u00eatre lue, on r\u00e9cup\u00e8re 00 00 00 00 00 00 Et on ne pourra jamais la lire sur une Mifare, il faut obligatoirement que le lecteur la connaisse au pr\u00e9alable ! Tip Pour modifier les cl\u00e9s facilement, il faut utiliser \"Easy Key\" . Utiliser Easy Key pour changer la cl\u00e9 A S'authentifier avec la Cl\u00e9 A : FF FF FF FF FF FF sur le sector 1 Updater la Cl\u00e9 A du Sector 1 en : FF FF FF FF AA 01 , puis cliquer sur Format Sector Tip Le bloc num\u00e9ro 3 du sector est updat\u00e9 automatiquement car c'est le Sector Trailer ! S'authentifier en utilisant la nouvelle cl\u00e9 sur le secteur 1 Modifier la cl\u00e9 B en ; FF FF FF FF BB 01 Tip On pourrait aussi modifier les Access Bits ... Verifier ces changements en essayant de lire les blocks 5 ou 6 avec les anciennes cl\u00e9s. Cela devrait \u00e9chouer. Le block 8 devrait fonctionner car il appartient au secteur 2 que nous n'avons pas modifi\u00e9. Charger les nouvelles cl\u00e9s et s'authentifier avec. Verifier que l'on peut maintenant lire les `blocks 4 & 5.","title":"ACR122u Tool - Read / Write Sector Trailer"},{"location":"06_mifare-classic-1k-hacking/#hack-de-cles-proxmark3","text":"Le Proxmark 3 est un outil qui permet des tests de penetration, du clonage et de la simulation de tag RFID. Il co\u00fbte environ 40\u20ac en Chine mais plus de 150\u20ac en Europe ... Il vient avec le logiciel proxmark3 qui lui est open source. Documentation Officielle PM3 Source utile . DISCLAIMER Dans ce cours nous ne hackerons que des cartes/badges personnelles dont nous avons nous m\u00eame crypt\u00e9 les donn\u00e9es ! Nous sommes des \"White Hats\" ! Tip Pour les besoins de ce cours j'ai flash\u00e9 le firmware modifi\u00e9 du developer \"Iceman\" ;) Iceman repo Pour utiliser le client `pm3 de Iceman : 1 2 3 \u276f pm3 ou \u276f proxmark3 /dev/tty.usbmodemiceman1","title":"Hack de Cl\u00e9s (Proxmark3)"},{"location":"06_mifare-classic-1k-hacking/#trouver-la-frequence-dun-badge-inconnu","text":"Il existe trois commandes principales : hw : pour l\u2019envoi de commandes hardware au Proxmark 3 ; lf et hf : pour manipuler la basse et la haute fr\u00e9quence. Tentons de d\u00e9tecter la fr\u00e9quence de fonctionnement d\u2019une carte NFC inconnue. Il existe une fonction dans le Proxmark 3 qui mesure la chute de tension induite dans l\u2019antenne lorsqu\u2019un tag s\u2019alimente. La commande hw tune renseigne les tensions pr\u00e9sentes dans les deux antennes (basse et haute fr\u00e9quences). Tip Si nous lan\u00e7ons le client avec le support Qt5, la commande tracera \u00e9galement une courbe de tension de l\u2019antenne basse fr\u00e9quence en fonction de la fr\u00e9quence utilis\u00e9e, montrant ainsi \u00e0 quelle fr\u00e9quence l\u2019antenne LF fonctionne de mani\u00e8re optimale. Si on mesure les tensions pr\u00e9sentes avant et apr\u00e8s l\u2019approche du tag sur les antennes haute et basse fr\u00e9quences, on observera une chute importante de la tension \u00e0 la fr\u00e9quence de fonctionnement du tag. Sans la carte : 1 2 3 4 5 6 7 8 9 10 11 12 13 [ usb ] pm3 --> hw tune [=] Measuring antenna characteristics, please wait... \ud83d\udd5a 10 [ + ] LF antenna: 40 .15 V - 125 .00 kHz [ + ] LF antenna: 34 .79 V - 134 .83 kHz [ + ] LF optimal: 42 .62 V - 127 .66 kHz [ + ] LF antenna is OK [ + ] HF antenna: 36 .26 V - 13 .56 MHz [ + ] HF antenna is OK [ + ] Displaying LF tuning graph. Divisor 88 is 134 .83 kHz, 95 is 125 .00 kHz. Avec la carte : 1 2 3 4 5 6 7 8 9 10 11 12 13 [ usb ] pm3 --> hw tune [=] Measuring antenna characteristics, please wait... \ud83d\udd56 10 [ + ] LF antenna: 40 .29 V - 125 .00 kHz [ + ] LF antenna: 34 .92 V - 134 .83 kHz [ + ] LF optimal: 42 .62 V - 127 .66 kHz [ + ] LF antenna is OK [ + ] HF antenna: 32 .76 V - 13 .56 MHz [ + ] HF antenna is OK [ + ] Displaying LF tuning graph. Divisor 88 is 134 .83 kHz, 95 is 125 .00 kHz. On voit que la tension a chut\u00e9 \u00e0 32.76 V lorsque l\u2019antenne haute fr\u00e9quence fonctionnait \u00e0 13.56 kHz . Dans le cas pr\u00e9sent, nous constatons donc que la carte inconnue fonctionne \u00e0 13.56 kHz . Tip C'est plus difficile \u00e0 voir avec un badge, car l'antenne est beaucoup plus petit. Dans mes essais, je n'ai pas not\u00e9 de diff\u00e9rence de voltage du tout avec le badge ...","title":"Trouver la fr\u00e9quence d'un badge inconnu"},{"location":"06_mifare-classic-1k-hacking/#default-keys-attack","text":"Cette attaque est simple, elle consiste \u00e0 v\u00e9rifier toutes les cl\u00e9s par d\u00e9faut des diff\u00e9rents constructeurs les une \u00e0 la suite des autres afin de trouver des secteurs qui les utilisent. Ce sera notre point d'entr\u00e9e pour la suite. Tip C'est un mini-bruteforce ! Nous utilisons la carte avec les cl\u00e9s modifi\u00e9es sur le secteur 1. 1 2 [ usb ] pm3 --> hf 14a info [ usb ] pm3 --> hf mf chk *1 ? t Success Tous les secteurs qui utilisent les cl\u00e9s par d\u00e9faut sont d\u00e9sormais accessibles, sauf notre secteur 1 qui r\u00e9siste encore.","title":"Default Keys Attack"},{"location":"06_mifare-classic-1k-hacking/#nested-attack","text":"L'\u00e9tape pr\u00e9cedente nous offre la possibilit\u00e9 de s'authentifier sur un ou plusieurs secteurs du badge avec les cl\u00e9s par d\u00e9faut. Cela nous ouvre les portes de la Nested Attack (De l'interieur). Info Le mifare classic 1k a un g\u00e9n\u00e9rateur de nombres al\u00e9atoires faible (RNG) qui est essentiellement un registre \u00e0 d\u00e9calage. Sa faiblesse vient de la possibilit\u00e9 de restaurer le nonce 1 g\u00e9n\u00e9r\u00e9 de 32 bits. Si nous nous authentifions plusieurs fois avec une cl\u00e9 connue, nous pouvons trouver le nombre m\u00e9dian de d\u00e9calages et deviner assez pr\u00e9cis\u00e9ment le nonce non crypt\u00e9 en annulant le nonce crypt\u00e9 (nous nous sommes d\u00e9j\u00e0 authentifi\u00e9s et nous connaissons le cryptage). Puisque ce nonce est initialis\u00e9 par la cl\u00e9 sym\u00e9trique XOR avec l'UID de la carte, nous pouvons effectivement trouver 32 bits de la cl\u00e9 de 48 bits. 1 [ usb ] pm3 --> hf mf nested 1 0 A FFFFFFFFFFFF t Success La/les cl\u00e9s manquantes sont trouv\u00e9es ! On peut lire le secteur : 1 [ usb ] pm3 --> hf mf rdsc 1 A ffffffffaa01 Danger Pour se prot\u00e9ger de ses 2 attaques il faut donc syst\u00e9matiquement modifier TOUTES les cl\u00e9s de TOUS les secteurs !!","title":"Nested Attack"},{"location":"06_mifare-classic-1k-hacking/#darkside-attack","text":"Tip Utiliser le badge jaune avec toutes les cl\u00e9s modifi\u00e9es (Cl\u00e9s : FF FF FF FF AA/BB <0xSectorNb>) ! Les manipulations ci-dessus n\u2019ont \u00e9t\u00e9 possibles que parce que nous avons d\u00e9couvert une cl\u00e9 par d\u00e9faut omise par les administrateurs des \u00e9quipements. L\u2019attaque dite Darkside ou de Courtois, du nom de son d\u00e9couvreur Nicolas Courtois, va tenter de retrouver une cl\u00e9 configur\u00e9e dans un tag en exploitant un d\u00e9faut dans l\u2019initialisation du g\u00e9n\u00e9rateur de nombres al\u00e9atoires du microcontr\u00f4leur du tag (le g\u00e9n\u00e9rateur commence toujours par la m\u00eame valeur lorsque la carte est aliment\u00e9e, donc si on contr\u00f4le finement le timing, on pr\u00e9dit le nombre al\u00e9atoire tir\u00e9 par le tag). D\u00e8s qu\u2019une premi\u00e8re cl\u00e9 est d\u00e9couverte, il sera alors possible de passer \u00e0 l\u2019attaque Nested. 1 [ usb ] pm3 --> hf mf darkside help Warn Ici aussi, si le tag MIFARE est trop r\u00e9cent, l\u2019attaque \u00e9chouera et on devra recourir \u00e0 d\u2019autres types d\u2019attaques. Success Nous avons trouv\u00e9 au moins une cl\u00e9 ! On peut donc utiliser une attaque nested pour trouver toute les autres :)","title":"Darkside Attack"},{"location":"06_mifare-classic-1k-hacking/#man-in-the-middle-attack","text":"Si la carte a r\u00e9sist\u00e9 aux attaques pr\u00e9cedentes, il faut sniffer la communication entre le lecteur et le carte. Une fois l'\u00e9change de cl\u00e9s identifi\u00e9, il faut utiliser l'outils CRAPTO1 , qui permet de cracker le code CRYPTO1 utilis\u00e9 par MiFare et d\u00e9coder la cl\u00e9 utilis\u00e9e ... Tip Le firmware iceman fait tout \u00e7a pour nous automatiquement ;) Pour l'attaque MIM, il nous faut avoir au lecteur l\u00e9gitime et au badge. Pour simuler l'authentification aupr\u00e8s du lecteur, j'ai \u00e9crit un programme JAVA dans la classe Acr122Manager.java . Brancher l'ACR122U au PC Lancer le programme d'authentification Brancher le PM3 Dans le client PM3 : hf 14a sniff pour d\u00e9clencher l'espionnage Coller le badge au PM3 et approcher le tout du lecteur plusieurs fois pour enregistrer plusieurs trames d'authentification. Appuyer sur le bouton du PM3 pour arreter le sniff. Dans le client PM3 : hf mf list pour d\u00e9coder les trames ... Success TADAA, on a directement la cl\u00e9 d\u00e9cod\u00e9e par l'outil, qui a css\u00e9 le code CRYPTO01 pour nous :) On peut de nouveau utiliser l'attaque nested pour trouver les autres secteurs :)","title":"Man-in-the-Middle Attack"},{"location":"06_mifare-classic-1k-hacking/#hardnested-attack","text":"Les tags MIFARE Classic r\u00e9cents ainsi que les MIFARE Plus SL1 sont plus robustes, car le g\u00e9n\u00e9rateur de nombres al\u00e9atoires et d\u2019autres d\u00e9fauts ont \u00e9t\u00e9 corrig\u00e9s. Mais ce ne sont pas les attaques contre la MIFARE qui manquent et une nouvelle attaque du type Card-Only existe, appel\u00e9e HardNested (pour Nested sur les cartes Hardened, durcies). Depuis la version 3.0.1 de Proxmark 3, l\u2019attaque HardNested est disponible dans le d\u00e9p\u00f4t principal (et iceman). Cette attaque va retrouver une cl\u00e9 dans les m\u00eames conditions que l\u2019attaque Nested, mais sur un tag r\u00e9cent, MIFARE Classic New Generation ou MIFARE Plus SL1. On lancera l\u2019attaque avec la commande hf mf hardnested 4 B xxxxxxxxxxxxx 0 B Tip Les arguments 4 , B et xxxxxxxxxxxxx correspondent \u00e0 une cl\u00e9 connue de notre badge, 0 et B la zone prot\u00e9g\u00e9e par la cl\u00e9 B que l\u2019on souhaite retrouver. Info Cette attaque met seulement 10 minutes maximum pour aboutir \u00e0 un r\u00e9sultat. Des d\u00e9tails peuvent \u00eatres trouv\u00e9s ici .","title":"HardNested Attack"},{"location":"06_mifare-classic-1k-hacking/#bruteforce-attack","text":"Dans tous les cas, on peut aussi tester toutes les combinaison possible de cl\u00e9 jusqu'\u00e0 en trouver une .... puis appliquer une Nested Attack. R\u00e9sultat en 2 jours garantis avec les rainbow tables et le firmware adapt\u00e9s ... Danger Les outils d'attaque par bruteforce sont par d\u00e9faut en dehors du cadre l\u00e9gal, nous ne le verrons pas dans ce cours ... Vous pouvez chercher personnellement dans la direction du firmware proxbrute ;)","title":"BruteForce Attack"},{"location":"06_mifare-classic-1k-hacking/#clonage","text":"Sur le badge a cloner : 1 2 [ usb ] pm3 --> hf mf nested 1 0 A FFFFFFFFFFFF d [ usb ] pm3 --> hf mf dump Sur un badge avec Chinese Backdoor (Pour pouvoir modifier l'UID) : 1 [ usb ] pm3 --> hf mf restore 1 <ID du badge source> Tip La modif de l'UID est faite automatiquement avec le firmware iceman ... sinon il suffit de faire hf mf csetuid <ID du badge source> Success Nous avons hack\u00e9 notre badge et toutes ses cl\u00e9s, puis dupliqu\u00e9 celui-ci en une copie intra\u00e7able :)","title":"Clonage"},{"location":"06_mifare-classic-1k-hacking/#conclusion","text":"Nous avons vu plusieurs cas d\u2019attaques possibles sur des tags RFID tr\u00e8s largement r\u00e9pandus dans le monde. De nombreux tags d\u2019ancienne technologie sont toujours disponibles \u00e0 la vente et encore largement en circulation, ce qui repr\u00e9sente un danger pour l'utilisateur non averti ! Heureusement, il existe d\u2019autres protocoles MIFARE, plus s\u00e9curis\u00e9s dans leurs \u00e9changes comme ceux des MIFARE Plus SL2 et SL3 qui impl\u00e9mentent la m\u00e9thode de chiffrement AES 128-bit et MIFARE DESFire qui impl\u00e9mente du 3DES et de l\u2019AES. En cryptographie, un nonce est un nombre arbitraire destin\u00e9 \u00e0 \u00eatre utilis\u00e9 une seule fois, souvent al\u00e9atoire. \u21a9","title":"Conclusion"}]}